// __multiversion__

#include "fragmentVersionSimple.h"
#include "uniformPerFrameConstants.h"
#include "uniformShaderConstants.h"

#include "functionIncludes.glsl"

varying vec3 pos;

void main(){

	vec3 np = normalize(vec3(pos.x, -pos.y + 0.128, -pos.z));
	vec3 up = normalize(vec3(0.0, abs(np.y), 0.0));
	vec3 usc = renderSkyColor(np, up, 1.0);

	float zs = dot(np, up);
	vec4 color = vec4(usc, pow(1.0-zs, 6.0));
		color.rgb = tonemap(color.rgb);

	gl_FragColor = color;
}
